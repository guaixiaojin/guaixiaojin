import{c as Ce,_ as $e,a as Se,b as be,d as Ie,e as Te,f as xe,g as ze,h as Be,i as Ne,j as Pe,k as Ue,l as Ve,m as Ae,n as Le,o as De,p as Me,q as Re,r as Fe,s as He,t as Je,u as Oe,v as Qe,w as je,x as Ee,y as Ge,z as Ke,A as We,B as Xe,C as Ye,D as Ze,E as es,F as ss,G as ns,H as ts,I as os,J as ls,K as is,L as _s,M as as,N as rs,O as us,P as cs,Q as vs,R as ds,S as ps,T as hs}from"./index.a65c15ed.js";import{_ as fs}from"./operation_follow.6643abf4.js";import{_ as ms}from"./ic_nav_close.4f0761b7.js";import{a as gs}from"./axios.8ade02f1.js";import{a as ks,B as ys,u as qs,r as a,o as ws,w as Cs,b as $s,c as S,d as q,e as l,h as r,k as d,g as z,T as le,D as b,j as e,l as m,t as i,m as f,n as _,p as Ss,f as D,F as M,i as R,q as B,I as ie}from"./index.3c14ef27.js";import"./_commonjsHelpers.6e81687c.js";const bs=""+new URL("share_item_collected.8e819247.png",import.meta.url).href;const Is={class:"Article-top"},Ts=e("div",{class:"logoheader"},[e("span"),e("p",null,"\u7CD7\u4E8B\u767E\u79D1")],-1),xs={class:"Article"},zs={class:"follow-top"},Bs={class:"follow-top-left"},Ns={class:"userimg"},Ps={key:0},Us={key:0},Vs={key:1},As={class:"follow-top-right"},Ls={key:0,src:fs},Ds=e("span",null,[e("img",{src:ms})],-1),Ms=["innerHTML"],Rs={class:"imgboxs"},Fs=["src"],Hs=e("span",null,null,-1),Js=e("span",null,null,-1),Os=e("span",null,null,-1),Qs={class:"imgboxc"},js=["src"],Es=e("span",null,null,-1),Gs=e("span",null,null,-1),Ks=e("span",null,null,-1),Ws={class:"picture"},Xs={class:"follow-footer"},Ys={class:"follow-footer-left"},Zs={class:"follow-footer-right"},en=e("span",null,null,-1),sn=e("span",null,null,-1),nn={key:0,class:"commit"},tn={class:"commitlength"},on={class:"commitlist-left"},ln={class:"commitlist-right"},_n={class:"list-top"},an={class:"list-top-left"},rn={class:"list-top-right"},un=["onClick"],cn={class:"title"},vn=e("span",{class:"reply"},"\u56DE\u590D",-1),dn={class:"commit"},pn={class:"commitlength"},hn={class:"commitlist-left"},fn={class:"commitlist-right"},mn={class:"list-top"},gn={class:"list-top-left"},kn={class:"list-top-right"},yn=["onClick"],qn={class:"title"},wn=e("span",{class:"reply"},"\u56DE\u590D",-1),Bn={__name:"ArticleView",setup(Cn){const p=ks(),g=ys(),w=qs(),F=a(!0),n=a([]),N=a([]),I=a([]);gs.get(`https://apis.netstart.cn/qiushi/article/${g.query.id}/comment/list?page=1&count=50`).then(o=>{console.log(o),I.value=o.data.hot_comments,n.value=o.data.article,N.value=o.data.items,F.value=!1});const u=a(),P=a(""),U=a([]),$=a([]),T=a([]);ws(()=>{Cs(u,o=>{o&&(u.value.oncanplay=()=>{const s=u==null?void 0:u.value;u.value.play(),u.value.ontimeupdate=()=>{var C;P.value=parseInt((s.duration-s.currentTime)/60)+":"+(parseInt((s.duration-s.currentTime)%60)>9?parseInt((s.duration-s.currentTime)%60):"0"+parseInt((s.duration-s.currentTime)%60));let h=s.currentTime/s.duration*((C=$==null?void 0:$.value)==null?void 0:C.offsetWidth);U.value.style.width=h+"rem",s.onended=()=>{T.value.style.display="flex"}}})})}),$s(()=>{u.value!=null&&(u.value.ontimeupdate=null)});const H=()=>{u.value.play(),T.value.style.display="none"},V=a(!1),_e=[[{name:"\u5FAE\u4FE1",icon:"wechat"},{name:"\u670B\u53CB\u5708",icon:"wechat-moments"},{name:"\u5FAE\u535A",icon:"weibo"},{name:"QQ",icon:"qq"}],[{name:"\u590D\u5236\u94FE\u63A5",icon:"link"},{name:"\u5206\u4EAB\u6D77\u62A5",icon:"poster"},{name:"\u4E8C\u7EF4\u7801",icon:"qrcode"},{name:"\u5C0F\u7A0B\u5E8F\u7801",icon:"weapp-qrcode"}]],{toClipboard:J}=Ce(),ae=()=>{J(`http://127.0.0.1:5173/article?id=${g.query.id}`)},k=a(!1),O=[{name:"\u590D\u5236"}],Q=o=>{k.value=!1,J(o),le("\u590D\u5236\u6210\u529F")},A=a(!1),re=[{name:"\u6536\u85CF",icon:bs}],ue=o=>{v.value.length!=0?(p.commit("getoncde",o),le.success("\u6536\u85CF\u6210\u529F")):b.alert({message:"\u8BF7\u767B\u5F55"}).then(()=>{w.push({path:"login",query:{from:`/article?id=${g.query.id}`}})})},ce=S(()=>p.state.followlist),ve=o=>{v.value.length!=0?p.commit("getfollowlist",o):b.alert({message:"\u8BF7\u767B\u5F55"}).then(()=>{w.push({path:"login",query:{from:`/article?id=${g.query.id}`}})})},de=()=>{w.back()},pe=(o,s,h)=>{let C=JSON.parse(JSON.stringify(h)).map(L=>L.pic_url);ie({images:C,showIndex:!0,loop:!1,startPosition:s,closeable:!0,closeIconPosition:"top-left"})},he=(o,s)=>{ie({images:[o],showIndex:!0,loop:!1,startPosition:s,closeable:!0,closeIconPosition:"top-left"})},j=S(()=>p.state.likes),fe=o=>{v.value.length!=0?p.commit("getactivecc",o):b.alert({message:"\u8BF7\u767B\u5F55"}).then(()=>{w.push({path:"login",query:{from:`/article?id=${g.query.id}`}})})},me=S(()=>p.state.notlikes),ge=o=>{v.value.length!=0?p.commit("getnotactivecc",o):b.alert({message:"\u8BF7\u767B\u5F55"}).then(()=>{w.push({path:"login",query:{from:`/article?id=${g.query.id}`}})})},ke=[$e,Se,be,Ie,Te,xe,ze,Be,Ne,Pe,Ue,Ve,Ae,Le,De,Me,Re,Fe,He,Je,Oe,Qe,je,Ee,Ge,Ke,We,Xe,Ye,Ze,es,ss,ns,ts,os,ls,is,_s,as,rs,us,cs,vs,ds,ps,hs],ye=a(0);for(let o of ke){let s=new Image;s.onload=()=>{ye.value++},s.src=o}const x=S(()=>p.state.translate),E=o=>{v.value.length!=0?p.commit("getTranslate",o):b.alert({message:"\u8BF7\u767B\u5F55"}).then(()=>{w.push({path:"login",query:{from:`/article?id=${g.query.id}`}})})},v=S(()=>p.state.token);return(o,s)=>{const h=q("van-image"),C=q("lazy-component"),L=q("van-grid-item"),qe=q("van-grid"),G=q("van-action-sheet"),we=q("van-skeleton"),K=q("van-share-sheet");return l(),r("div",null,[d(we,{title:"",avatar:"",row:24,loading:F.value},{default:z(()=>{var y,W,X,Y,Z,ee,se,ne,te,oe;return[e("div",Is,[e("div",{class:"logo-back",onClick:de}),Ts,e("div",{class:"logo-follow",onClick:s[0]||(s[0]=t=>A.value=!0)})]),e("div",xs,[e("div",zs,[e("div",Bs,[e("p",null,[d(h,{round:"",width:"35rem",height:"35rem",src:(W=(y=n.value)==null?void 0:y.user)==null?void 0:W.medium},null,8,["src"])]),e("div",Ns,[n.value.user?(l(),r("p",Ps,[m(i(n.value.user.login),1),n.value.user.titles?(l(),r("span",Us,[d(h,{fit:"cover",width:"15rem",height:"15rem",src:n.value.user.titles[0].icon,alt:""},null,8,["src"])])):f("",!0)])):f("",!0),(Y=(X=n.value)==null?void 0:X.user)!=null&&Y.talents?(l(),r("p",Vs,i(n.value.user.talents[0].cmd_desc),1)):f("",!0)])]),e("div",As,[e("span",{onClick:s[1]||(s[1]=t=>ve(n.value.user))},[!_(ce).map(t=>t.id).includes(n.value.user.id)||_(v).length==0?(l(),r("img",Ls)):f("",!0)]),Ds])]),e("p",{class:"title",innerHTML:n.value.content},null,8,Ms),n.value.pic_size&&n.value.pic_size[0]-n.value.pic_size[1]<0&&n.value.pic_url?(l(),r("div",{key:0,class:"video",ref_key:"videoboss",ref:$},[e("div",{class:"mark",style:Ss(`background-image:url('${n.value.pic_url}')`)},null,4),e("div",Rs,[e("video",{class:"videos",ref_key:"videos",ref:u,src:n.value.low_url,muted:""},null,8,Fs)]),e("p",null,i(P.value),1),e("span",{ref_key:"one",ref:U,class:"one"},null,512),e("div",{class:"logo",ref_key:"logo",ref:T},[e("span",{onClick:H}),Hs,Js,Os],512)],512)):f("",!0),n.value.pic_size&&n.value.pic_size[0]-n.value.pic_size[1]>=0&&n.value.pic_url?(l(),r("div",{key:1,class:"video",ref_key:"videoboss",ref:$},[d(C,null,{default:z(()=>[e("div",Qs,[e("video",{class:"videos",ref_key:"videos",ref:u,src:n.value.low_url,muted:""},null,8,js)])]),_:1}),e("p",null,i(P.value),1),e("span",{ref_key:"one",ref:U,class:"one"},null,512),e("div",{class:"logo",ref_key:"logo",ref:T},[e("span",{onClick:H}),Es,Gs,Ks],512)],512)):f("",!0),e("div",Ws,[n.value.attachments?(l(),D(qe,{key:0,"column-num":3},{default:z(()=>[(l(!0),r(M,null,R(n.value.attachments,(t,c)=>(l(),D(L,{key:c},{default:z(()=>[d(h,{fit:"cover",width:"100%",height:"110rem",src:t.origin_url,onClick:$n=>pe(t.pic_url,c,n.value.attachments)},null,8,["src","onClick"])]),_:2},1024))),128))]),_:1})):f("",!0),!n.value.attachments&&!((Z=n.value.high_url)!=null&&Z.toString().includes("mp4"))&&n.value.high_url?(l(),D(h,{key:1,fit:"cover",width:"100%",height:"100%",src:(ee=n.value)==null?void 0:ee.high_url,onClick:s[2]||(s[2]=t=>he(n.value.high_url,0))},null,8,["src"])):f("",!0)]),e("div",Xs,[e("div",Ys,[e("p",null,[e("span",{class:B({active:_(j).includes(n.value.id)&&_(v).length!=0}),onClick:s[3]||(s[3]=t=>fe(n.value.id))},null,2),m(i(_(j).includes(n.value.id)?((ne=(se=n.value)==null?void 0:se.votes)==null?void 0:ne.up)+1:(oe=(te=n.value)==null?void 0:te.votes)==null?void 0:oe.up),1),e("span",{onClick:s[4]||(s[4]=t=>ge(n.value.id)),class:B({notactive:_(me).includes(n.value.id)&&_(v).length!=0})},null,2)])]),e("div",Zs,[e("p",{onClick:s[5]||(s[5]=t=>V.value=!0)},[en,m(i(n.value.comments_count),1),sn,m("\u5206\u4EAB")])])])]),I.value.length!=0?(l(),r("div",nn,[e("p",tn,[m("\u70ED\u95E8\u8BC4\u8BBA"),e("span",null,i(I.value.length),1)]),(l(!0),r(M,null,R(I.value,t=>(l(),r("div",{class:"commitlist",key:t.id},[e("div",on,[d(h,{round:"",width:"40rem",height:"40rem",src:t.user.medium},null,8,["src"])]),e("div",ln,[e("div",_n,[e("div",an,[e("p",null,i(t.user.login),1),e("span",null,i(t.ip_location),1)]),e("div",rn,[e("span",{class:"listshase",onClick:s[6]||(s[6]=c=>k.value=!0)}),e("div",null,[e("span",{onClick:c=>E(t.id),class:B({translate:_(x).includes(t.id)&&_(v).length!=0})},null,10,un),m(i(_(x).includes(t.id)?t.like_count+1:t.like_count==0?"":t.like_count),1)])])]),e("p",cn,i(t.content),1),vn]),d(G,{show:k.value,"onUpdate:show":s[7]||(s[7]=c=>k.value=c),actions:O,onSelect:c=>Q(t.content)},null,8,["show","onSelect"])]))),128))])):f("",!0),e("div",dn,[e("p",pn,[m("\u6700\u65B0\u8BC4\u8BBA"),e("span",null,i(N.value.length),1)]),(l(!0),r(M,null,R(N.value,t=>(l(),r("div",{class:"commitlist",key:t.id},[e("div",hn,[d(h,{round:"",width:"40rem",height:"40rem",src:t.user.medium},null,8,["src"])]),e("div",fn,[e("div",mn,[e("div",gn,[e("p",null,i(t.user.login),1),e("span",null,i(t.ip_location),1)]),e("div",kn,[e("span",{class:"listshase",onClick:s[8]||(s[8]=c=>k.value=!0)}),e("div",null,[e("span",{onClick:c=>E(t.id),class:B({translate:_(x).includes(t.id)&&_(v).length!=0})},null,10,yn),m(i(_(x).includes(t.id)&&_(v).length!=0?t.like_count+1:t.like_count==0?"":t.like_count),1)])])]),e("p",qn,i(t.content),1),wn]),d(G,{show:k.value,"onUpdate:show":s[9]||(s[9]=c=>k.value=c),actions:O,onSelect:c=>Q(t.content)},null,8,["show","onSelect"])]))),128))])]}),_:1},8,["loading"]),d(K,{show:V.value,"onUpdate:show":s[10]||(s[10]=y=>V.value=y),title:"\u5206\u4EAB\u5230",onSelect:ae,options:_e},null,8,["show"]),d(K,{show:A.value,"onUpdate:show":s[11]||(s[11]=y=>A.value=y),options:re,onSelect:s[12]||(s[12]=y=>ue(n.value))},null,8,["show"])])}}};export{Bn as default};
